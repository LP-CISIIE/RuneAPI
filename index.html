<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>RuneAPI by LP-CISIIE</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">RuneAPI</h1>
      <h2 class="project-tagline">Unofficial API and Interface for RuneAudio</h2>
      <a href="https://github.com/LP-CISIIE/RuneAPI" class="btn">View on GitHub</a>
      <a href="https://github.com/LP-CISIIE/RuneAPI/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/LP-CISIIE/RuneAPI/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="runeaudio--one-player-to-rune-them-all" class="anchor" href="#runeaudio--one-player-to-rune-them-all" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>RuneAudio : “One player to rune them all.”</h1>

<blockquote>
<p>RuneAudio est un logiciel libre qui permet de transformer un micro-pc (raspberry, odroid...) en un système HI-FI. A partir d'une source il est alors possible de transmettre un son à partir de plusieurs sources (webradio, NAS, USB).</p>
</blockquote>

<p><img src="https://github.com/LP-CISIIE/RuneAPI/blob/master/img/how-it-works.png?raw=true" alt="runeaudio"></p>

<hr>

<h3>
<a id="explication-du-sujet" class="anchor" href="#explication-du-sujet" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Explication du sujet</h3>

<p>Actuellement RuneaAudio ne permet pas de développer une interface tiers, ou de rassembler plusieurs appareils sur la même interface.
Le but de notre projet et de résoudre ces deux problématiques </p>

<ul>
<li>Créer une API</li>
</ul>

<blockquote>
<p>Dans un premier temps nous devions créer une API, permettant de communiquer facilement avec le système de gestion de musique. Nous devions donc permettre à tous de pouvoir créer sa propre interface facilement.</p>
</blockquote>

<ul>
<li>Créer une interface</li>
</ul>

<blockquote>
<p>Par la suite nous avons créé une interface utilisant notre API, afin de résoudre notre second problème, contrôler plusieurs appareils sur la même interface</p>
</blockquote>

<hr>

<h3>
<a id="réalisation-de-lapi" class="anchor" href="#r%C3%A9alisation-de-lapi" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Réalisation de l'API</h3>

<p>Nous avons choisi de développer notre API en PHP en utilisant le framework SLIM 2.
Voici un exemple de déclaration de route: </p>

<p><img src="https://github.com/LP-CISIIE/RuneAPI/blob/master/img/route.PNG?raw=true" alt="route"></p>

<ul>
<li>Dans $app-&gt;rootUri est stocké l'adresse IP de l'API</li>
<li>$app-&gt;get définit le type de requête qui sera fait (GET, POST, PUT), il a pour paramètre l'URI par laquelle on accède à la requete et une fonction qui sera executé lorsque l'utilisateur fera appel à cette URI</li>
<li>mpdController::getMpd($app); fait appel à la fonction qui est appelé lorsque cette URL est appelé.</li>
</ul>

<blockquote>
<p>Nous avons choisi de retourner les informations aux formats JSON, pour la simplicité de ce format expoloitable et décodable dans de nombreux langages.</p>
</blockquote>

<p>Voici un exemple de retour d'une requete sur l'API:
<img src="https://github.com/LP-CISIIE/RuneAPI/blob/master/img/source.PNG?raw=true" alt="source"></p>

<hr>

<h3>
<a id="réalisation-de-linterface" class="anchor" href="#r%C3%A9alisation-de-linterface" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Réalisation de l'interface</h3>

<p>L'interface que nous avons réalisé est entièrement conçu en AngularJS. Nous nous sommes tout d'abord concentré sur les fonctionnalités principales et au style graphique de notre interface avant de nous étendre vers des fonctionnalités moins importantes</p>

<blockquote>
<p>Nous avons choisit d'opter pour une interface minimaliste et facile d'utilisation, qui est aussi bien adapté à l'utilisation sur ordinateur, tablette ou mobile.</p>
</blockquote>

<h3>
<a id="routes-de-lapi" class="anchor" href="#routes-de-lapi" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Routes de l'API</h3>

<p><strong>GET</strong> /player/play      :   Lance la musique</p>

<p><strong>GET</strong> /player/pause     :   met la musique sur pause</p>

<p><strong>GET</strong>  /player/stop      :   stop la musique</p>

<p><strong>GET</strong> /player/next      :   passe à la musique précédente</p>

<p><strong>GET</strong> /player/previous  :   passe à la musique précédente</p>

<hr>

<p><strong>GET</strong> /playlist/repeatOn             : lance la playlist en boucle</p>

<p><strong>GET</strong>  /playlist/repeatOff            : la playlist s’arrête à la fin</p>

<p><strong>GET</strong> /playlist/SoundRepeatOn        : La musique est joué en boucle</p>

<p><strong>GET</strong> /playlist/SoundRepeatOff       : La musique n'est plus joué en boucle</p>

<hr>

<p><strong>PUT</strong> /volume/:nb                    : Change le volume à nb (0 a 100)</p>

<hr>

<p><strong>GET</strong> /gestion/:pos/:temps           : A partir du n° dans la playlist définit le temps ( en seconde ) de la lecture.(avancer ou reculer la musique)</p>

<hr>

<p><strong>GET</strong> /sources                       : Récupère les sources USB uniquement</p>

<p><strong>GET</strong> /sources/edit/:id              : Affiche un NAS</p>

<hr>

<p><strong>GET</strong> /sources                       : Modifier paramètre des sources</p>

<hr>

<p><strong>POST</strong> /sources/delete               : Supprime un nas</p>

<p>`{</p>

<p>"id" : ""</p>

<p>}`</p>

<p><strong>POST</strong> /sources/add                  : Ajoute une nouvelle source</p>

<p>`{</p>

<pre><code>"name" : "",

"id" : "",

"type" : "",

"address" : "",

"remotedir" : "",

"nas" : "",

"username" : "",

"password" : "",

"charset"  : "",

"rsize" : "",

"wsize" : "",

"options" : "",

"error" : ""
</code></pre>

<p>}`</p>

<hr>

<p><strong>GET</strong> /mpd                             : Récupère le page de configuration du MPD</p>

<hr>

<p><strong>PUT</strong> /mpd/analogique                  : Change l'output en analogique</p>

<p><strong>PUT</strong> /mpd/hdmi                        : Change l'output en HDMI</p>

<hr>

<p><strong>POST</strong> /mpd                            : Modifie les paramètres du MPD</p>

<p>`{</p>

<pre><code>"mixer_type": "",

"user": "",

"log_level" : "",

"state_file" : "",

"ffmpeg" : "",

"gapless_mp3_playback" : "",

"dsd_usb" : "",

"volume_normalization" : "",

"audio_buffer_size" : "",

"buffer_before_play" : "",

"auto_update" : "n"
</code></pre>

<p>}`</p>

<hr>

<p><strong>GET</strong> /network                          : Récupère la page de configuration du network</p>

<p><strong>GET</strong> /network/eth0                     : Récupère la page de configuration ethernet</p>

<p><strong>GET</strong> /network/wlan0                    : Récupère la page de configuration wifi</p>

<hr>

<p><strong>POST</strong> /network                         : Modifie information de connexion</p>

<p>`{</p>

<pre><code>"name": "",

"wireless": "",

"dhcp" : "",

"ip" : "",

"netmask" : "",

"gw" : "",

"dns1" : "",

"dns2" : ""
</code></pre>

<p>}`</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/LP-CISIIE/RuneAPI">RuneAPI</a> is maintained by <a href="https://github.com/LP-CISIIE">LP-CISIIE</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
